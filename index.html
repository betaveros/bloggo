<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8" />

  
  <title>Bounded-Error Log</title>

  
  





<meta name="author" content="betaveros" />
<meta name="description" content="" />




<meta name="generator" content="Hugo 0.31-DEV" />


<link rel="canonical" href="//blog.vero.site/" />
<link rel="alternative" href="/index.xml" title="Bounded-Error Log" type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />




<link rel="icon" href="/favicon.ico" />


<link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700|Fira+Sans:400,400i,700" rel="stylesheet">
<link rel="stylesheet" href="/css/bundle.css" />
<link rel="stylesheet" href="/katex/katex.min.css" />


  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body><div id="wrapper">
    
<header class="site-header">
	
	<h1 class="title"><a href="/">Bounded-Error Log</a></h1>
	
	<p class="subtitle">theoretical and applied randomness by <a href="https://beta.vero.site/">betaveros</a></p>
	<button class="menu-toggle" type="button" aria-label="Toggle Menu">
		<span class="icon icon-menu" aria-hidden="true"></span>
	</button>
	<nav class="site-menu collapsed">
		<h2 class="offscreen">Main Menu</h2>
		<ul class="menu-list">
			
			
			
			
			<li class="menu-item "><a href="/about">About</a></li>
			
			<li class="menu-item "><a href="/category/life">Life</a></li>
			
			<li class="menu-item "><a href="/category/thoughts">Thoughts</a></li>
			
			<li class="menu-item "><a href="/category/self-analysis">Self-Analysis</a></li>
			
			<li class="menu-item "><a href="/category/math">Math</a></li>
			
			<li class="menu-item "><a href="/category/cs">CS</a></li>
			
			<li class="menu-item "><a href="/category/puzzles">Puzzles</a></li>
			
			<li class="menu-item "><a href="/category/meta">Meta</a></li>
			
			<li class="menu-item "><a href="/util">Utilities</a></li>
			
		</ul>
	</nav>
	<nav class="social-menu collapsed">
		<h2 class="offscreen">Social Networks</h2>
		<ul class="social-list">

			

			
			<li class="social-item">
				<a href="//github.com/betaveros" title="GitHub" aria-label="GitHub"><span class="icon icon-github" aria-hidden="true"></span></a>
			</li>

			

			<li class="social-item">
				<a href="/index.xml" title="RSS" aria-label="RSS"><span class="icon icon-rss" aria-hidden="true"></span></a>
			</li>

		</ul>
	</nav>
</header>

<section class="main post-list">
	<header class="list-header offscreen">
		<h2 class="list-label">Everything</h2>
	</header>
	
	
		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/shellql" class="post-link">shellql</a></h3>
		
		<h4 class="post-subtitle">DEF CON CTF Qualifiers 2018</h4>
		
		<p class="post-meta">
		
		2018-05-13
		(1217 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>The hardest challenge of not very many I solved in this CTF. What a struggle! I have a long way to improve. It was pretty fun though. (I solved “You Already Know”, and got the essence of “ghettohackers: Throwback”, but didn’t guess the right flag format and believe I was asleep when they released the hint about it.)</p>
<p>The challenge consists of a simple PHP script that opens a MySQL connection and then feeds our input into a custom PHP extension <code>shellme.so</code>.</p>
<pre class="sourceCode php"><code class="sourceCode php"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">$link</span> = <span class="fu">mysqli_connect</span><span class="ot">(</span><span class="st">&#39;localhost&#39;</span><span class="ot">,</span> <span class="st">&#39;shellql&#39;</span><span class="ot">,</span> <span class="st">&#39;shellql&#39;</span><span class="ot">,</span> <span class="st">&#39;shellql&#39;</span><span class="ot">);</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"></div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="kw">if</span> <span class="ot">(</span><span class="kw">isset</span><span class="ot">(</span><span class="kw">$_POST</span><span class="ot">[</span><span class="st">&#39;shell&#39;</span><span class="ot">]))</span></div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">{</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">   <span class="kw">if</span> <span class="ot">(</span><span class="fu">strlen</span><span class="ot">(</span><span class="kw">$_POST</span><span class="ot">[</span><span class="st">&#39;shell&#39;</span><span class="ot">])</span> &lt;= <span class="dv">1000</span><span class="ot">)</span></div>
<div class="sourceLine" id="6" href="#6" data-line-number="6">   {</div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">      <span class="kw">echo</span> <span class="kw">$_POST</span><span class="ot">[</span><span class="st">&#39;shell&#39;</span><span class="ot">];</span></div>
<div class="sourceLine" id="8" href="#8" data-line-number="8">      shellme<span class="ot">(</span><span class="kw">$_POST</span><span class="ot">[</span><span class="st">&#39;shell&#39;</span><span class="ot">]);</span></div>
<div class="sourceLine" id="9" href="#9" data-line-number="9">   }</div>
<div class="sourceLine" id="10" href="#10" data-line-number="10">   <span class="kw">exit</span><span class="ot">();</span></div>
<div class="sourceLine" id="11" href="#11" data-line-number="11">}</div></code></pre>
<p>The extension basically just executes <code>$_POST['shell']</code> as shellcode after a strict SECCOMP call, <a href="http://man7.org/linux/man-pages/man2/prctl.2.html">prctl</a>(<a href="https://elixir.bootlin.com/linux/v4.16.8/source/include/uapi/linux/prctl.h#L68">22</a>, <a href="https://elixir.bootlin.com/linux/v4.1/source/include/uapi/linux/seccomp.h#L10">1</a>). This means that we can only use the four syscalls <code>read</code>, <code>write</code>, and <code>exit</code>, and <code>sigreturn</code>, where the latter two aren’t particularly useful.</p>
<figure>
<img src="/img/shell_this.png" alt="Disassembled innermost function of interest in shellme.so" /><figcaption>Disassembled innermost function of interest in <code>shellme.so</code></figcaption>
</figure>
<p>The goal is to read the flag from the open MySQL connection.</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/shellql">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/doggo" class="post-link">Pupper/Doggo</a></h3>
		
		<h4 class="post-subtitle">PlaidCTF 2018</h4>
		
		<p class="post-meta">
		
		2018-05-06
		(2909 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>We are presented with a big zip file of SML code, which implements an interpreter for a small ML-like language with a form of taint analysis in its type checker, called <em>Wolf</em>. Concretely, every type in Wolf’s type system has an associated <em>secrecy</em>: it is either “private” or “public”, and in theory, the type system makes it impossible to do any computation on private data to get a public result.</p>
<p>Of course, this is a CTF, so the challenge is all about breaking the theoretical guarantees of the type system. When we submit code, it’s evaluated in a context with a private integer variable <code>flag</code>; our code is typechecked, executed, and printed, but only if its type is public. The goal is to break the type system and write code that produces a public value that depends on <code>flag</code>, so that we can exfiltrate <code>flag</code> itself.</p>
<p>In all, there are three progressively harder Wolf problems, named Pupper, Doggo, and Woofer. Doggo and Woofer are each encrypted with the flag of the challenge before it, so that you need to solve them in order (unless you can somehow blindly exploit servers running SML programs).</p>
<h3 id="wolf-overview">Wolf Overview</h3>
<p>Let’s first go over the Wolf syntax and semantics. (There are small differences between the three problems, but they’re syntactically identical and only semantically differ in cases that we’ll naturally get to.) The <code>examples</code> folder has some examples of valid code:</p>
<pre class="sourceCode ml"><code class="sourceCode ocaml"><div class="sourceLine" id="1" href="#1" data-line-number="1"><span class="kw">let</span> x = (<span class="dv">5</span> :&gt; <span class="kw">private</span> <span class="dt">int</span>) <span class="kw">in</span></div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="dv">6</span></div></code></pre>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/doggo">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/messy-desk" class="post-link">Messy Desk</a></h3>
		
		<h4 class="post-subtitle">PlaidCTF 2018</h4>
		
		<p class="post-meta">
		
		2018-05-06
		(1000 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>This challenge is a video of somebody’s messy desk, with what is apparently the audio from a <a href="https://www.youtube.com/watch?v=WwnI0RS6J5A">Futurama clip</a>. The desk is indeed extremely messy and full of things that aren’t particularly useful for us, but close examination reveals a QR code reflected in the globe in the middle.</p>
<p>The challenge is all about getting that QR code. After trying our best to clean up the image, we ended up with this:</p>
<figure>
<img src="/img/messy-qr.png" alt="Maximally enhanced image of the QR code" /><figcaption>Maximally enhanced image of the QR code</figcaption>
</figure>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/messy-desk">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/on-delete-facebook" class="post-link">On #DeleteFacebook</a></h3>
		
		<p class="post-meta">
		
		2018-04-02
		(9808 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/thoughts">Thoughts</a>
		</span>
		
		</p>
	</header>
	
	<p>It feels a little surreal watching #DeleteFacebook.</p>
<p>On one hand, despite how hard it is to keep an issue trending in today’s fast news cycle, this issue has managed to continue burning for a while. Somewhat recently (March 21), we got two high-profile Facebook account deletions from <a href="https://twitter.com/brianacton/status/976231995846963201">Brian Acton (WhatsApp cofounder)</a> and <a href="https://techcrunch.com/2018/03/23/elon-musk-deletes-own-spacex-and-tesla-facebook-pages-after-deletefacebook/">Elon Musk</a>. Other apparent examples include <a href="https://www.usatoday.com/story/money/2018/03/28/playboy-dumps-facebook-amid-public-furor-over-users-data-leaks/465156002/">Playboy and Cher</a>, or see <a href="http://time.com/money/5220854/delete-facebook-celebrities-companies-cutting-ties-privacy/">Time</a> or <a href="https://www.cnet.com/news/several-companies-and-people-are-pulling-back-from-facebook/">CNET</a> for a few more. Facebook’s U.S. and Canada user base <a href="https://www.recode.net/2018/1/31/16957122/facebook-daily-active-user-decline-us-canda-q4-earnings-2018">declined for the first time last quarter</a>.</p>
<p>On the other hand, for me and for a lot of people, the scandal just doesn’t seem that qualitatively different from things we’ve known about Facebook for a long time — its stance on privacy, its psychological effects, its willingness to manipulate the user experience. Why is this time different? (Here’s the <a href="https://www.reddit.com/r/NoStupidQuestions/comments/87u9ro/why_is_everyone_all_of_a_sudden_mad_at_facebook/">/r/NoStupidQuestions thread.</a> I don’t actually know which answer I believe the most.)</p>
<p>Is this time really different? I’m not optimistic. The decline could simply be Facebook running out of potential users to add and space to grow. According to a recent Raymond James survey, about half of surveyed users did not plan to change how much they used Facebook, while only 8% would stop using it, and this may still be an overestimate of people who will actually leave or delete their accounts.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> Mark Zuckerberg himself <a href="https://www.nytimes.com/2018/03/21/technology/mark-zuckerberg-q-and-a.html">told the New York Times</a>, “I don’t think we’ve seen a meaningful number of people act on [the #DeleteFacebook campaign]”.</p>
<p>I myself have to admit upfront that, even though I <a href="//blog.vero.site/post/me-and-facebook">barely use Facebook any more</a> and have carefully contemplated deleting my Facebook account for a long time, I still haven’t pulled the trigger.</p>
<p>Why? What will it take to change this?</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/on-delete-facebook">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/2018-hunt" class="post-link">2018 MIT Mystery Hunt</a></h3>
		
		<p class="post-meta">
		
		2018-01-16
		(4882 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/puzzles">Puzzles</a>
		</span>
		
		</p>
	</header>
	
	<p>My third MIT Mystery Hunt with ✈✈✈ Galactic Trendsetters ✈✈✈ (also see: <a href="//blog.vero.site/post/january">2017</a> and <a href="//blog.vero.site/post/whoosh">2016</a>, writing with Random in <a href="//blog.vero.site/post/hunt">2015</a>). It was a good hunt with a fun theme, solid puzzles, and extraordinary production quality, marred only by a fickle unlock structure and a handful of unnecessarily involved extractions.</p>
<p>Since we had been told the hunt would be smaller than past years’ (now a controversial statement since the coin was <em>not</em> found particularly early) and we didn’t particularly want to win (yet), part of our team temporarily split off this year to hunt as Teammate. Based on our Discord channel, ✈✈✈ Galactic Trendsetters ✈✈✈ had 75 people this year, including remote solvers and people who dropped in and out.</p>
<p>A short description of the hunt structure: This year’s hunt theme was <em>Inside Out</em>, the Disney movie about anthropomorphized emotions. This was revealed through a kickoff that demonstrated the hunt’s extraordinary production quality, in which we watched the unveiling of the Health &amp; Safety hunt, first directly, then in the Control Room with the emotions of a distraught hunter (Miss Terry Hunter) and a lot of beautiful memory orbs and scenery. After Terry’s emotions became overwhelmed in response to the theme, we had to help her emotions to allow her to complete the Health &amp; Safety hunt. The intro round took place in the Control Room; we had to solve 34 regular puzzles and five metapuzzles (somewhat overlapping, with some regular puzzles belonging to more than one metapuzzle) to help each of the five emotions get back to the Control Room. The rest of the hunt consisted of recovering memory orbs from each of four Islands of Personality, each of which had its own theme and meta structure, and which we could choose the unlock order of.</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/2018-hunt">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/transformation" class="post-link">Transformation</a></h3>
		
		<p class="post-meta">
		
		2017-12-31
		(1619 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/life">Life</a>
		</span>
		
		</p>
	</header>
	
	<p>I think this is the right video for this year.</p>

<div style="position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/lX44CAz-JhU" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" allowfullscreen frameborder="0" title="YouTube Video"></iframe>
 </div>

<p>I love the music and the animation. The music video spells out the central conceit somewhat explicitly, but I think the lyrics by themselves have a hint of ambiguity — is it a harmful addiction that you just can’t escape from, or an essential part of your identity that you just can’t deny?</p>
<p>What parts of me can I just not deny, huh? Unfortunately 2017 is also the year I decide my online presence should probably be a little more professional, so you might have to read between the lines a bit. </p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/transformation">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/thoroughly-stripped" class="post-link">Thoroughly Stripped</a></h3>
		
		<h4 class="post-subtitle">CSAW CTF 2017 Finals (Forensics, 200 pts)</h4>
		
		<p class="post-meta">
		
		2017-11-12
		(1142 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>Woo, first CTF writeup. I got the opportunity to participate in the 2017 CSAW CTF finals with Don’t Hack Alone.</p>
<blockquote>
<p>Dumped by my core, left to bleed out bytes on the heap, I was stripped of my dignity… The last thing I could do was to let other programs strip me of my null-bytes just so my memory could live on.</p>
</blockquote>
<p>We are provided with a core dump. Examining the flavor-text and the dump, we notice that the dump has no null bytes; we conjecture that they have been stripped out.</p>
<p>Next, we examine the hexdump and look for any clues. There are a bunch of ASCII strings, but they look like normal debugging symbols. One thing that jumps out is that there are a couple fairly convincing regular striped patterns that become vertically aligned if you display 20 bytes in each line. Once we do that, we notice the following section. (This dump is from <a href="https://github.com/betaveros/xxb"><code>xxb</code></a> but <code>xxd -c 20 thoroughlyStripped</code> is quite sufficient.)</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/thoroughly-stripped">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/sakura" class="post-link">Sakura</a></h3>
		
		<h4 class="post-subtitle">HITCON CTF 2017</h4>
		
		<p class="post-meta">
		
		2017-11-12
		(703 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>(Okay, this post is backdated.)</p>
<p>Disassembling the executable produces a huge amount of code. There are some basic obfuscations like a lot of trivial identity functions nested in each other, and a few functions that wrap around identity functions but just add some constant multiple of 16. Most of the meat is in one very large function, though. If you disassemble this function with IDA, you see a lot of variable initializations and then a lot of interesting loops that are quite similar:</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/sakura">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/hello-again" class="post-link">Hello, Again</a></h3>
		
		<p class="post-meta">
		
		2017-11-07
		(1930 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/meta">Meta</a>
		</span>
		
		</p>
	</header>
	
	<p>And here we are.</p>
<p>This is the first post on this blog after I migrated off WordPress for a static solution.</p>
<p>At first, I wanted to set things up on Amazon Web Services (AWS), which was an adventure. There are lots of online posts about how to do this, but Amazon’s services change quickly and there was often outdated information. For instance, Amazon had a wizard that led you through setting up a static site, which I clicked on. It helpfully handled a lot of grunt work, but now I was out of sync with all of the guides. Oh well.</p>
<p>I think things are confusing partly because there are four AWS components all interacting to make a static site happen:</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/hello-again">→ read more</a>
	</footer>
</article>

		
			<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/remigration" class="post-link">Remigration</a></h3>
		
		<p class="post-meta">
		
		2017-11-05
		(758 words)
		
		</p>
	</header>
	
	<p>I guess I lied in my penultimate post.</p>
<p>I’m planning on migrating my primary blog (again), off WordPress to a static site hosted somewhere. I might just throw everything onto GitHub Pages, or might follow any of the zillions of tutorials on how to host static sites off a cheap Amazon S3 bucket — I haven’t decided yet, but no longer having to rely on the free part of freemium services is fairly liberating.</p>
<p>Why? Lots of small reasons.</p>
<p></p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/remigration">→ read more</a>
	</footer>
</article>

		
	
	
	<footer class="list-footer">
		<nav class="pagination">
			<h3 class="offscreen">Pagination</h3>
			
			
				<a class="pagination-next" href="/page/2">Older Posts →</a>
			
		</nav>
	</footer>
	
</section>
<footer class="site-footer">
	<p>© 2017-2018 betaveros, Bounded-Error Log</p>
	<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />Except where otherwise noted, content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
	<p>Powered by <a href="https://gohugo.io/">Hugo</a>, <a href="http://pandoc.org/">pandoc</a>,
	<a href="https://pages.github.com/">GitHub Pages</a>, and
	<a href="https://www.cloudflare.com/">CloudFlare</a>.
	</p>
</footer>


<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>

<script src="/katex/katex.min.js"></script>
<script src="/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body);</script>
<script src="/js/bundle.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>



  </div></body>
</html>
