<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8" />
<title>
Tag ‚Üí CTF

 | Bounded-Error Log
</title>

<meta name="author" content="betaveros" />
<meta name="description" content="" /><meta name="generator" content="Hugo 0.102.0-DEV" />

<link rel="canonical" href="//blog.vero.site/tag/ctf" />
<link rel="alternative" href="/index.xml" title="Bounded-Error Log" type="application/atom+xml" />

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />

<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />
<meta name="theme-color" content="#330000" />
<meta name="twitter:creator" content="@betaveros">

<link rel="icon" href="/favicon.ico" />

<link rel="stylesheet" href="/css/bundle.css" />
<link rel="stylesheet" href="/katex/katex.min.css" />

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

</head>
<body>
<div id="wrapper">
<header class="site-header"><h2 class="title"><a href="/">Bounded-Error Log</a></h2><p class="subtitle">theoretical and applied randomness by <a href="https://beta.vero.site/">betaveros</a></p>
<button class="menu-toggle" type="button" aria-label="Toggle Menu">
	<span class="icon icon-menu" aria-hidden="true"></span>
</button>
<nav class="site-menu collapsed">
	<h2 class="offscreen">Main Menu</h2>
	<ul class="menu-list"><li class="menu-item "><a href="/about">About</a></li><li class="menu-item "><a href="/category/life">Life</a></li><li class="menu-item "><a href="/category/thoughts">Thoughts</a></li><li class="menu-item "><a href="/category/self-analysis">Self-Analysis</a></li><li class="menu-item "><a href="/category/math">Math</a></li><li class="menu-item "><a href="/category/cs">CS</a></li><li class="menu-item "><a href="/category/puzzles">Puzzles</a></li><li class="menu-item "><a href="/category/meta">Meta</a></li><li class="menu-item "><a href="/ref">References</a></li><li class="menu-item "><a href="/util">Utilities</a></li><li class="menu-item "><a href="/all">All Posts</a></li></ul>
</nav>
<nav class="social-menu collapsed">
	<h2 class="offscreen">Social Networks</h2>
	<ul class="social-list"><li class="social-item">
			<a href="//github.com/betaveros" title="GitHub" aria-label="GitHub"><span class="icon icon-github" aria-hidden="true"></span></a>

		</li><li class="social-item">
			<a href="/index.xml" title="RSS" aria-label="RSS"><span class="icon icon-rss" aria-hidden="true"></span></a>
		</li>
	</ul>
</nav>
</header>

<section class="main post-list">
	<header class="list-header">
		<h2 class="list-label">
			Tag ‚Üí CTF
			
		</h2>
	</header>
	<article class="content"></article><article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/pppordle" class="post-link">üÖøÔ∏èüÖøÔ∏èüÖøÔ∏èordle</a></h3>
		
		<h4 class="post-subtitle">PlaidCTF 2022 (350 points)</h4>
		
		<p class="post-meta">
		
		2022-07-04
		(1890 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>Don‚Äôt you hate it when CTFs happen faster than you can write them up? This is probably the only PlaidCTF challenge I get to, unfortunately.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<blockquote>
<p>Web is out, retro is in. Play your favorite word game from the comfort of your terminal!</p>
</blockquote>
<p>It‚Äôs a terminal Wordle client!</p>
<figure>
<a href="/img/pppordle-1.png"><img src="/img/pppordle-1.png" alt="Screenshot of a terminal Wordle client. The puzzle has been solved with the answer COZEY." /></a>
</figure>
<p>I only solved the first half of this challenge. The two halves seem to be unrelated though. (Nobody solved the second half during the CTF.) The challenge was quite big code-wise, with more than a dozen files, so it‚Äôs hard to replicate the experience in a post like this, but here‚Äôs an attempt.</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/pppordle">‚Üí read more<span class="offscreen"> üÖøÔ∏èüÖøÔ∏èüÖøÔ∏èordle</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/mask" class="post-link">Mask</a></h3>
		
		<h4 class="post-subtitle">√•ngstromCTF 2022 (200 points)</h4>
		
		<p class="post-meta">
		
		2022-07-04
		(2519 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>Don‚Äôt forget to wear your mask‚Ä¶</p>
<p><code>nc challs.actf.co 31501</code></p>
</blockquote>
<p>If I had a nickel for every <a href="//blog.vero.site/post/messy-desk">CTF challenge I‚Äôve done</a> that involves understanding the internal structure of a QR code, I would have two nickels. Which isn‚Äôt a lot, etc etc. That previous challenge probably helped me get first blood on this.</p>
<p>The source code is wonderfully short:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="im">import</span> io, qrcode, string</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">flag_contents <span class="op">=</span> [REDACTED]</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="cf">assert</span> <span class="bu">all</span>(i <span class="kw">in</span> string.ascii_lowercase <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> flag_contents)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">flag <span class="op">=</span> b<span class="st">&quot;actf{&quot;</span> <span class="op">+</span> flag_contents.encode() <span class="op">+</span> b<span class="st">&quot;}&quot;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="bu">print</span>(<span class="st">&quot;flag is </span><span class="sc">%d</span><span class="st"> characters&quot;</span> <span class="op">%</span> <span class="bu">len</span>(flag))</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">qr <span class="op">=</span> qrcode.QRCode(version<span class="op">=</span><span class="dv">1</span>, error_correction <span class="op">=</span> qrcode.constants.ERROR_CORRECT_L, box_size<span class="op">=</span><span class="dv">1</span>, border<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="cf">while</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="cf">try</span>:</a>
<a class="sourceLine" id="cb1-12" title="12">        inp <span class="op">=</span> <span class="bu">bytes</span>.fromhex(<span class="bu">input</span>(<span class="st">&quot;give input (in hex): &quot;</span>))</a>
<a class="sourceLine" id="cb1-13" title="13">        <span class="cf">assert</span> <span class="bu">len</span>(inp) <span class="op">==</span> <span class="bu">len</span>(flag)</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="cf">except</span>:</a>
<a class="sourceLine" id="cb1-15" title="15">        <span class="bu">print</span>(<span class="st">&quot;bad input, exiting&quot;</span>)</a>
<a class="sourceLine" id="cb1-16" title="16">        <span class="cf">break</span></a>
<a class="sourceLine" id="cb1-17" title="17">    qr.clear()</a>
<a class="sourceLine" id="cb1-18" title="18">    qr.add_data(<span class="bu">bytes</span>([i<span class="op">^</span>j <span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(inp, flag)]))</a>
<a class="sourceLine" id="cb1-19" title="19">    f <span class="op">=</span> io.StringIO()</a>
<a class="sourceLine" id="cb1-20" title="20">    qr.print_ascii(out<span class="op">=</span>f)</a>
<a class="sourceLine" id="cb1-21" title="21">    f.seek(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-22" title="22">    <span class="bu">print</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(i[:<span class="dv">11</span>] <span class="cf">for</span> i <span class="kw">in</span> f))</a></code></pre></div>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/mask">‚Üí read more<span class="offscreen"> Mask</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/kevin-higgs" class="post-link">Kevin Higgs</a></h3>
		
		<h4 class="post-subtitle">√•ngstromCTF 2022 (210 points)</h4>
		
		<p class="post-meta">
		
		2022-07-04
		(1366 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>Now that kmh is gone, clam‚Äôs been going through pickle withdrawal. To help him cope, he wrote his own pickle pyjail. It‚Äôs nothing like kmh‚Äôs, but maybe it‚Äôs enough.</p>
</blockquote>
<p>Language jails are rapidly becoming one of my CTF areas of expertise. Not sure how I feel about that.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/usr/local/bin/python3</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="im">import</span> pickle</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="im">import</span> io</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">module <span class="op">=</span> <span class="bu">type</span>(__builtins__)</a>
<a class="sourceLine" id="cb1-8" title="8">empty <span class="op">=</span> module(<span class="st">&quot;empty&quot;</span>)</a>
<a class="sourceLine" id="cb1-9" title="9">empty.empty <span class="op">=</span> empty</a>
<a class="sourceLine" id="cb1-10" title="10">sys.modules[<span class="st">&quot;empty&quot;</span>] <span class="op">=</span> empty</a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">class</span> SafeUnpickler(pickle.Unpickler):</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="kw">def</span> find_class(<span class="va">self</span>, module, name):</a>
<a class="sourceLine" id="cb1-15" title="15">        <span class="cf">if</span> module <span class="op">==</span> <span class="st">&quot;empty&quot;</span> <span class="kw">and</span> name.count(<span class="st">&quot;.&quot;</span>) <span class="op">&lt;=</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1-16" title="16">            <span class="cf">return</span> <span class="bu">super</span>().find_class(module, name)</a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="cf">raise</span> pickle.UnpicklingError(<span class="st">&quot;e-legal&quot;</span>)</a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20">lepickle <span class="op">=</span> <span class="bu">bytes</span>.fromhex(<span class="bu">input</span>(<span class="st">&quot;Enter hex-encoded pickle: &quot;</span>))</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="cf">if</span> <span class="bu">len</span>(lepickle) <span class="op">&gt;</span> <span class="dv">400</span>:</a>
<a class="sourceLine" id="cb1-22" title="22">    <span class="bu">print</span>(<span class="st">&quot;your pickle is too large for my taste &gt;:(&quot;</span>)</a>
<a class="sourceLine" id="cb1-23" title="23"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1-24" title="24">    SafeUnpickler(io.BytesIO(lepickle)).load()</a></code></pre></div>
<p><code><a href="https://docs.python.org/3/library/pickle.html">pickle</a></code> is a Python object serialization format. As the docs page loudly proclaims, it is not secure. Roughly the simplest possible code to pop a shell (adapted from <a href="https://davidhamann.de/2020/04/05/exploiting-python-pickle/">David Hamann</a>, who constructs a more realistic RCE) looks like:</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/kevin-higgs">‚Üí read more<span class="offscreen"> Kevin Higgs</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/caasio" class="post-link">CaaSio PSE</a></h3>
		
		<h4 class="post-subtitle">√•ngstromCTF 2022 (250 points)</h4>
		
		<p class="post-meta">
		
		2022-07-04
		(773 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>It‚Äôs clam‚Äôs newest javascript Calculator-as-a-Service: the CaaSio Please Stop Edition! no but actually please stop I hate jsjails js isn‚Äôt a good language stop putting one in every ctf I don‚Äôt want to look at another jsjail because if I do I might vomit from how much I hate js and js quirks aren‚Äôt even cool or funny or quirky they‚Äôre just painful because why would you design a language like this ahhhhhhhhhhhhhhhhhhhhh</p>
</blockquote>
<p>It‚Äôs just a JavaScript eval jail.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/usr/local/bin/node</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">// flag in ./flag.txt</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">const</span> vm <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;vm&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">const</span> readline <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;readline&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">const</span> <span class="kw">interface</span> <span class="op">=</span> <span class="va">readline</span>.<span class="at">createInterface</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="dt">input</span><span class="op">:</span> <span class="va">process</span>.<span class="at">stdin</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="dt">output</span><span class="op">:</span> <span class="va">process</span>.<span class="at">stdout</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">interface</span>.<span class="at">question</span>(</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="st">&quot;Welcome to CaaSio: Please Stop Edition! Enter your calculation:</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-15" title="15">    <span class="kw">function</span> (input) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-16" title="16">        <span class="kw">interface</span>.<span class="at">close</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="cf">if</span> (</a>
<a class="sourceLine" id="cb1-18" title="18">            <span class="va">input</span>.<span class="at">length</span> <span class="op">&lt;</span> <span class="dv">215</span> <span class="op">&amp;&amp;</span></a>
<a class="sourceLine" id="cb1-19" title="19">            <span class="ss">/</span><span class="sc">^[\x20-\x7e]+$</span><span class="ss">/</span>.<span class="at">test</span>(input) <span class="op">&amp;&amp;</span></a>
<a class="sourceLine" id="cb1-20" title="20">            <span class="op">!</span><span class="ss">/</span><span class="sc">[.\[\]{}\s;`&#39;&quot;\\_&lt;&gt;?:]</span><span class="ss">/</span>.<span class="at">test</span>(input) <span class="op">&amp;&amp;</span></a>
<a class="sourceLine" id="cb1-21" title="21">            <span class="op">!</span><span class="va">input</span>.<span class="at">toLowerCase</span>().<span class="at">includes</span>(<span class="st">&quot;import&quot;</span>)</a>
<a class="sourceLine" id="cb1-22" title="22">        ) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-23" title="23">            <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-24" title="24">                <span class="kw">const</span> val <span class="op">=</span> <span class="va">vm</span>.<span class="at">runInNewContext</span>(input<span class="op">,</span> <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-25" title="25">                <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Result:&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-26" title="26">                <span class="va">console</span>.<span class="at">log</span>(val)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-27" title="27">                <span class="va">console</span>.<span class="at">log</span>(</a>
<a class="sourceLine" id="cb1-28" title="28">                    <span class="st">&quot;See, isn&#39;t the calculator so much nicer when you&#39;re not trying to hack it?&quot;</span></a>
<a class="sourceLine" id="cb1-29" title="29">                )<span class="op">;</span></a>
<a class="sourceLine" id="cb1-30" title="30">            <span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-31" title="31">                <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;your tried&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-32" title="32">            <span class="op">}</span></a>
<a class="sourceLine" id="cb1-33" title="33">        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-34" title="34">            <span class="va">console</span>.<span class="at">log</span>(</a>
<a class="sourceLine" id="cb1-35" title="35">                <span class="st">&quot;Third time really is the charm! I&#39;ve finally created an unhackable system!&quot;</span></a>
<a class="sourceLine" id="cb1-36" title="36">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb1-37" title="37">        <span class="op">}</span></a>
<a class="sourceLine" id="cb1-38" title="38">    <span class="op">}</span></a>
<a class="sourceLine" id="cb1-39" title="39">)<span class="op">;</span></a></code></pre></div>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/caasio">‚Üí read more<span class="offscreen"> CaaSio PSE</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/ti1337se" class="post-link">TI-1337 Silver Edition</a></h3>
		
		<h4 class="post-subtitle">DiceCTF 2022 (Misc, 299 pts)</h4>
		
		<p class="post-meta">
		
		2022-02-14
		(3740 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>Last weekend <a href="https://galhacktictrendsetters.wordpress.com/">Galhacktic Trendsetters</a> sort of spontaneously decided to do <a href="https://ctf.dicega.ng/">DiceCTF 2022</a>, months or years after most of us had done another CTF. It was a lot of fun and we placed 6th!</p>
<blockquote>
<p>Back in the day the silver edition was the top of the line Texas Instruments calculator, but now the security is looking a little obsolete. Can you break it?</p>
</blockquote>
<p>It‚Äôs yet another Python jail. We input a string and, after it makes it through a gauntlet of checks and processing, it gets <code>exec</code>‚Äôd.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/usr/bin/env python3</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="im">import</span> dis</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">banned <span class="op">=</span> [<span class="st">&quot;MAKE_FUNCTION&quot;</span>, <span class="st">&quot;CALL_FUNCTION&quot;</span>, <span class="st">&quot;CALL_FUNCTION_KW&quot;</span>, <span class="st">&quot;CALL_FUNCTION_EX&quot;</span>]</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">used_gift <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">def</span> gift(target, name, value):</a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="kw">global</span> used_gift</a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="cf">if</span> used_gift: sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">    used_gift <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1-13" title="13">    <span class="bu">setattr</span>(target, name, value)</a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="bu">print</span>(<span class="st">&quot;Welcome to the TI-1337 Silver Edition. Enter your calculations below:&quot;</span>)</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17">math <span class="op">=</span> <span class="bu">input</span>(<span class="st">&quot;&gt; &quot;</span>)</a>
<a class="sourceLine" id="cb1-18" title="18"><span class="cf">if</span> <span class="bu">len</span>(math) <span class="op">&gt;</span> <span class="dv">1337</span>:</a>
<a class="sourceLine" id="cb1-19" title="19">    <span class="bu">print</span>(<span class="st">&quot;Nobody needs that much math!&quot;</span>)</a>
<a class="sourceLine" id="cb1-20" title="20">    sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-21" title="21">code <span class="op">=</span> <span class="bu">compile</span>(math, <span class="st">&quot;&lt;math&gt;&quot;</span>, <span class="st">&quot;exec&quot;</span>)</a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23">bytecode <span class="op">=</span> <span class="bu">list</span>(code.co_code)</a>
<a class="sourceLine" id="cb1-24" title="24">instructions <span class="op">=</span> <span class="bu">list</span>(dis.get_instructions(code))</a>
<a class="sourceLine" id="cb1-25" title="25"><span class="cf">for</span> i, inst <span class="kw">in</span> <span class="bu">enumerate</span>(instructions):</a>
<a class="sourceLine" id="cb1-26" title="26">    <span class="cf">if</span> inst.is_jump_target:</a>
<a class="sourceLine" id="cb1-27" title="27">        <span class="bu">print</span>(<span class="st">&quot;Math doesn&#39;t need control flow!&quot;</span>)</a>
<a class="sourceLine" id="cb1-28" title="28">        sys.exit(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-29" title="29">    nextoffset <span class="op">=</span> instructions[i<span class="op">+</span><span class="dv">1</span>].offset <span class="cf">if</span> i<span class="op">+</span><span class="dv">1</span> <span class="op">&lt;</span> <span class="bu">len</span>(instructions) <span class="cf">else</span> <span class="bu">len</span>(bytecode)</a>
<a class="sourceLine" id="cb1-30" title="30">    <span class="cf">if</span> inst.opname <span class="kw">in</span> banned:</a>
<a class="sourceLine" id="cb1-31" title="31">        bytecode[inst.offset:instructions[i<span class="op">+</span><span class="dv">1</span>].offset] <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>(instructions[i<span class="op">+</span><span class="dv">1</span>].offset<span class="op">-</span>inst.offset)</a>
<a class="sourceLine" id="cb1-32" title="32"></a>
<a class="sourceLine" id="cb1-33" title="33">names <span class="op">=</span> <span class="bu">list</span>(code.co_names)</a>
<a class="sourceLine" id="cb1-34" title="34"><span class="cf">for</span> i, name <span class="kw">in</span> <span class="bu">enumerate</span>(code.co_names):</a>
<a class="sourceLine" id="cb1-35" title="35">    <span class="cf">if</span> <span class="st">&quot;__&quot;</span> <span class="kw">in</span> name: names[i] <span class="op">=</span> <span class="st">&quot;$INVALID$&quot;</span></a>
<a class="sourceLine" id="cb1-36" title="36"></a>
<a class="sourceLine" id="cb1-37" title="37">code <span class="op">=</span> code.replace(co_code<span class="op">=</span><span class="bu">bytes</span>(b <span class="cf">for</span> b <span class="kw">in</span> bytecode <span class="cf">if</span> b <span class="op">&gt;=</span> <span class="dv">0</span>), co_names<span class="op">=</span><span class="bu">tuple</span>(names), co_stacksize<span class="op">=</span><span class="dv">2</span><span class="op">**</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb1-38" title="38">v <span class="op">=</span> {}</a>
<a class="sourceLine" id="cb1-39" title="39"><span class="bu">exec</span>(code, {<span class="st">&quot;__builtins__&quot;</span>: {<span class="st">&quot;gift&quot;</span>: gift}}, v)</a>
<a class="sourceLine" id="cb1-40" title="40"><span class="cf">if</span> v: <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(<span class="ss">f&quot;</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>val<span class="sc">}</span><span class="ss">&quot;</span> <span class="cf">for</span> name, val <span class="kw">in</span> v.items()))</a>
<a class="sourceLine" id="cb1-41" title="41"><span class="cf">else</span>: <span class="bu">print</span>(<span class="st">&quot;No results stored.&quot;</span>)</a></code></pre></div>
<p>More precisely, the gauntlet does the following:</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/ti1337se">‚Üí read more<span class="offscreen"> TI-1337 Silver Edition</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/blazingfast" class="post-link">blazingfast</a></h3>
		
		<h4 class="post-subtitle">DiceCTF 2022 (Web, 140 pts)</h4>
		
		<p class="post-meta">
		
		2022-02-14
		(1404 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<p>Last weekend <a href="https://galhacktictrendsetters.wordpress.com/">Galhacktic Trendsetters</a> sort of spontaneously decided to do <a href="https://ctf.dicega.ng/">DiceCTF 2022</a>, months or years after most of us had done another CTF. It was a lot of fun and we placed 6th!</p>
<blockquote>
<p>I made a blazing fast MoCkInG CaSe converter!</p>
<p>blazingfast.mc.ax</p>
</blockquote>
<p>We‚Äôre presented with a website that converts text to AlTeRnAtInG CaSe. The core converter is written in WASM, and also checks that its input doesn‚Äôt have any of the characters <code>&lt;&gt;&amp;"</code>. The JavaScript wrapper takes an input from the URL, converts it to uppercase, feeds it to the converter, and if the check passes, injects the output into an <code>innerHTML</code>. The goal is to compose a URL that, when visited by an admin bot, leaks the flag from <code>localStorage</code>.</p>
<p>The converter is compiled from this C code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb1-1" title="1"><span class="dt">int</span> length, ptr = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="dt">char</span> buf[<span class="dv">1000</span>];</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="dt">void</span> init(<span class="dt">int</span> size) {</a>
<a class="sourceLine" id="cb1-5" title="5">    length = size;</a>
<a class="sourceLine" id="cb1-6" title="6">    ptr = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-7" title="7">}</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="dt">char</span> read() {</a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="cf">return</span> buf[ptr++];</a>
<a class="sourceLine" id="cb1-11" title="11">}</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="dt">void</span> write(<span class="dt">char</span> c) {</a>
<a class="sourceLine" id="cb1-14" title="14">    buf[ptr++] = c;</a>
<a class="sourceLine" id="cb1-15" title="15">}</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="dt">int</span> mock() {</a>
<a class="sourceLine" id="cb1-18" title="18">    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; length; i ++) {</a>
<a class="sourceLine" id="cb1-19" title="19">        <span class="cf">if</span> (i % <span class="dv">2</span> == <span class="dv">1</span> &amp;&amp; buf[i] &gt;= <span class="dv">65</span> &amp;&amp; buf[i] &lt;= <span class="dv">90</span>) {</a>
<a class="sourceLine" id="cb1-20" title="20">            buf[i] += <span class="dv">32</span>;</a>
<a class="sourceLine" id="cb1-21" title="21">        }</a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23">        <span class="cf">if</span> (buf[i] == <span class="ch">&#39;&lt;&#39;</span> || buf[i] == <span class="ch">&#39;&gt;&#39;</span> || buf[i] == <span class="ch">&#39;&amp;&#39;</span> || buf[i] == <span class="ch">&#39;&quot;&#39;</span>) {</a>
<a class="sourceLine" id="cb1-24" title="24">            <span class="cf">return</span> <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb1-25" title="25">        }</a>
<a class="sourceLine" id="cb1-26" title="26">    }</a>
<a class="sourceLine" id="cb1-27" title="27"></a>
<a class="sourceLine" id="cb1-28" title="28">    ptr = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-29" title="29"></a>
<a class="sourceLine" id="cb1-30" title="30">    <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-31" title="31">}</a></code></pre></div>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/blazingfast">‚Üí read more<span class="offscreen"> blazingfast</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/callsite" class="post-link">callsite</a></h3>
		
		<h4 class="post-subtitle">CSAW CTF Qualifiers 2019</h4>
		
		<p class="post-meta">
		
		2019-09-16
		(561 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>Call me maybe? <code>nc rev.chal.csaw.io 1001</code></p>
</blockquote>
<p>A rev with a nasty binary. There are so many functions. I do not like this binary.</p>
<figure>
<a href="/img/callsite-gross.png"><img src="/img/callsite-gross.png" alt="Screenshot of IDA Pro on the callsite binary, with a lot of code and functions." /></a>
</figure>
<h3 id="static-analysis">Static Analysis</h3>
<p>After staring at the sea of functions in IDA for a little bit, I gave up and tried dumb things instead.</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/callsite">‚Üí read more<span class="offscreen"> callsite</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/unagi" class="post-link">unagi</a></h3>
		
		<h4 class="post-subtitle">CSAW CTF Qualifiers 2019</h4>
		
		<p class="post-meta">
		
		2019-09-15
		(568 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>come get me</p>
<p>http://web.chal.csaw.io:1003</p>
</blockquote>
<p>This was a web challenge with a few pages. The ‚ÄúUser‚Äù page displayed some user information:</p>
<figure>
<a href="/img/unagi-user.png"><img src="/img/unagi-user.png" alt="Screenshot of User page, transcribed below" /></a>
</figure>
<blockquote>
<p>Name: Alice<br />
Email: alice@fakesite.com<br />
Group: CSAW2019<br />
Intro: Alice is cool</p>
<p>Name: Bob<br />
Email: bob@fakesite.com<br />
Group: CSAW2019<br />
Intro: Bob is cool too</p>
</blockquote>
<p>The ‚ÄúAbout‚Äù page simply told us, ‚ÄúFlag is located at /flag.txt, come get it‚Äù. The most interesting page was ‚ÄúUpload‚Äù, where we could view an example users XML file:</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/unagi">‚Üí read more<span class="offscreen"> unagi</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/baby-boi" class="post-link">baby_boi (A Textbook CTF ROP Tutorial)</a></h3>
		
		<h4 class="post-subtitle">CSAW CTF Qualifiers 2019</h4>
		
		<p class="post-meta">
		
		2019-09-15
		(1867 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<blockquote>
<p>Welcome to pwn.</p>
<p><code>nc pwn.chal.csaw.io 1005</code></p>
</blockquote>
<p>Ahhh, CSAW CTF. Amidst all the other CTFs where we‚Äôre competing with security professionals who probably have decades of experience and who follow security developments for a living or whatever, there remains a competition where scrubs like me can apply our extremely basic CTF skills and still feel kinda smart by earning points. Now that I‚Äôve graduated and am no longer eligible, our team was pretty small and I didn‚Äôt dedicate the full weekend to the CTF, but it means I got to do the really easy challenges in the categories that I was the worst at, by which I mean pwn.</p>
<p><code>baby_boi</code> is pretty much the simplest possible modern ROP (the modern security protections NX and ASLR are not artificially disabled, but you get everything you need to work around them). We even get source code.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb1-1" title="1"><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv[]) {</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">char</span> buf[<span class="dv">32</span>];</a>
<a class="sourceLine" id="cb1-6" title="6">  printf(<span class="st">&quot;Hello!</span><span class="sc">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb1-7" title="7">  printf(<span class="st">&quot;Here I am: %p</span><span class="sc">\n</span><span class="st">&quot;</span>, printf);</a>
<a class="sourceLine" id="cb1-8" title="8">  gets(buf);</a>
<a class="sourceLine" id="cb1-9" title="9">}</a></code></pre></div>
<p>So there‚Äôs nothing novel here for experienced pwners, but I feel like there is a shortage of tutorials that walk you through how to solve a textbook ROP the way you‚Äôd want to solve it in a CTF, so here is a writeup.</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/baby-boi">‚Üí read more<span class="offscreen"> baby_boi (A Textbook CTF ROP Tutorial)</span></a>
	</footer>
</article>

		<article class="post-entry">
	<header class="post-header">
		<h3 class="post-title"><a href="//blog.vero.site/post/refrain" class="post-link">refrain</a></h3>
		
		<h4 class="post-subtitle">0CTF/TCTF 2019 Quals</h4>
		
		<p class="post-meta">
		
		2019-03-27
		(2427 words)
		
		<span class="post-categories">
			filed under
			<a href="/category/cs">CS</a>
		</span>
		
		</p>
	</header>
	
	<pre><code>http://111.186.63.17/perf.data.gz

Environment: Ubuntu 16.04+latex</code></pre>
<p>In this challenge, we get a gzipped file called <code>perf.data</code> and a minimal description of an environment. Googling this reveals that <code>perf.data</code> is a record format of the <code>perf</code> tool, a Linux profiler. Installing <code>perf</code> allows us to read <code>perf.data</code> and see some pretty interactive tables of statistics in our terminal describing the profiling results, from which we can see some libraries and addresses being called, but they don‚Äôt reveal much about what‚Äôs going on. One hacky way to see more of the underlying data in a more human-readable way (and to see just how much of it there is) is <code>perf report -D</code>, which dumps the raw data in an ASCII format, but this is still not that useful. (One might hope that one could simply grep for the flag in this big text dump, but it‚Äôs nowhere to be seen.) Still, from this file, we can definitely read off all the exact library versions that the <code>perf record</code> was run against.</p>
	<footer class="post-footer">
		<a class="read-more" href="//blog.vero.site/post/refrain">‚Üí read more<span class="offscreen"> refrain</span></a>
	</footer>
</article>

		<footer class="list-footer">
		<nav class="pagination">
			<h3 class="offscreen">Pagination</h3><a class="pagination-next" href="/tag/ctf/page/2">older posts ‚Üí</a></nav>
	</footer></section>
</div>
<footer class="site-footer">
	<p>¬© 2017-2023 betaveros, Bounded-Error Log</p>
	<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />Except where otherwise noted, content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
	<p>Powered by <a href="https://gohugo.io/">Hugo</a>, <a href="http://pandoc.org/">pandoc</a>,
	<a href="https://www.goatcounter.com/">GoatCounter</a>,
	<a href="https://posativ.org/isso/">Isso</a>,
	<a href="https://pages.github.com/">GitHub Pages</a>, and
	<a href="https://www.cloudflare.com/">CloudFlare</a>.
	</p>
	<p>Opinions are mine and not of any employer, past or present.</p>
</footer>

<script src="/katex/katex.min.js"></script>
<script src="/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body);</script>
<script src="/js/bundle.js"></script>
<script>window.goatcounter = { path: function(p) { return '/blog' + p; } }</script>
<script data-goatcounter="https://node.vero.site:8073/count" async src="https://node.vero.site:8073/count.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>


</body>
</html>
